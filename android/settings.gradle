pluginManagement {
    repositories {
        google()
        mavenCentral()
        gradlePluginPortal()

        // Flutter artifacts
        maven { url "https://storage.googleapis.com/download.flutter.io" }
    }
}

dependencyResolutionManagement {
    repositoriesMode.set(RepositoriesMode.FAIL_ON_PROJECT_REPOS)
    repositories {
        google()
        mavenCentral()
        maven { url "https://storage.googleapis.com/download.flutter.io" }
    }
}

rootProject.name = "visora_ai"

// Flutter SDK path automatically detected via .flutter-plugins-dependencies
def flutterProjectRoot = rootDir.getAbsoluteFile()

def flutterSdkPath = new File(flutterProjectRoot, ".flutter-sdk").exists()
        ? flutterProjectRoot.toPath().resolve(".flutter-sdk").toString()
        : System.getenv("FLUTTER_SDK")

if (flutterSdkPath == null || flutterSdkPath.trim().isEmpty()) {
    throw new GradleException("Flutter SDK not found in CI. Please ensure flutter-action installs it.")
}

// Apply flutter toolchain
apply from: "${flutterSdkPath}/packages/flutter_tools/gradle/flutter.gradle"

// Include app module
include ":app"
